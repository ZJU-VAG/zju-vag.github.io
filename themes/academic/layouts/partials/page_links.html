{{ $is_list := .is_list }}
{{ $page := .page }}
{{ $link := "" }}

{{/* ***** TODO: Deprecate `url_preprint` in favour of `url_pdf` given there's now a dedicated "Preprint" pub. type. ***** */}}
{{ with $page.Params.url_preprint }}
  {{ $resource := $page.Resources.GetMatch . }}
  {{ if $resource }}
    {{ $link = $resource.RelPermalink }}
  {{ else }}
    {{ $link = . | relURL }}
  {{ end }}
  <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ $link }}" target="_blank"
  rel="noopener">
  {{ i18n "btn_preprint" }}
  </a>
{{ end }}


{{ $pdf := "" }}
{{ $resource := $page.Resources.GetMatch (printf "%s.pdf" $page.File.ContentBaseName) }}
{{ with $resource }}
  {{ $pdf = .RelPermalink }}
  {{ with $pdf }}
    <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
    {{ i18n "btn_pdf" }}
    </a>
  {{ end }}
  {{ else }}
    {{ range $page.Params.url_pdf }}
      <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
      {{ i18n "btn_pdf" }}
      </a>
    {{ end }}
{{ end }}


{{ $code := "" }}
{{ $resource := $page.Resources.GetMatch (printf "%s.code.*" $page.File.ContentBaseName) }}
{{ with $resource }}
  {{ $code = .RelPermalink }}
  {{ with $code }}
    <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
    {{ i18n "btn_code" }}
    </a>
  {{ end }}
  {{ else }}
    {{ range $page.Params.url_code }}
      <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
      {{ i18n "btn_code" }}
      </a>
    {{ end }}
{{ end }}


{{ $dataset := "" }}
{{ $resource := $page.Resources.GetMatch (printf "%s.dataset.*" $page.File.ContentBaseName) }}
{{ with $resource }}
  {{ $dataset = .RelPermalink }}
  {{ with $dataset }}
    <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
    {{ i18n "btn_dataset" }}
    </a>
  {{ end }}
  {{ else }}
    {{ range $page.Params.url_dataset }}
      <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
      {{ i18n "btn_dataset" }}
      </a>
    {{ end }}
{{ end }}


{{ $poster := "" }}
{{ $resource := $page.Resources.GetMatch (printf "%s.poster.*" $page.File.ContentBaseName) }}
{{ with $resource }}
  {{ $poster = .RelPermalink }}
  {{ with $poster }}
    <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
    {{ i18n "btn_poster" }}
    </a>
  {{ end }}
  {{ else }}
    {{ range $page.Params.url_poster }}
      <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
      {{ i18n "btn_poster" }}
      </a>
    {{ end }}
{{ end }}


{{ $slides := "" }}
{{ $resource := $page.Resources.GetMatch (printf "%s.slides.*" $page.File.ContentBaseName) }}
{{ with $resource }}
  {{ $slides = .RelPermalink }}
  {{ with $slides }}
    <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
    {{ i18n "btn_slides" }}
    </a>
  {{ end }}
  {{ else }}
    {{ range $page.Params.url_slides }}
      <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
      {{ i18n "btn_slides" }}
      </a>
    {{ end }}
{{ end }}


{{ $video := "" }}
{{ $resource := $page.Resources.GetMatch (printf "%s.video.*" $page.File.ContentBaseName) }}
{{ with $resource }}
  {{ $video = .RelPermalink }}
  {{ with $video }}
    <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
    {{ i18n "btn_video" }}
    </a>
  {{ end }}
  {{ else }}
    {{ range $page.Params.url_video }}
      <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
      {{ i18n "btn_video" }}
      </a>
    {{ end }}
{{ end }}


{{ $source := "" }}
{{ $resource := $page.Resources.GetMatch (printf "%s.source.*" $page.File.ContentBaseName) }}
{{ with $resource }}
  {{ $source = .RelPermalink }}
  {{ with $source }}
    <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
    {{ i18n "btn_source" }}
    </a>
  {{ end }}
  {{ else }}
    {{ range $page.Params.url_source }}
      <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
      {{ i18n "btn_source" }}
      </a>
    {{ end }}
{{ end }}

{{ $supp := "" }}
{{ $resource := $page.Resources.GetMatch (printf "%s.supp.*" $page.File.ContentBaseName) }}
{{ with $resource }}
  {{ $supp = .RelPermalink }}
  {{ with $supp }}
    <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
    {{ i18n "btn_supp" }}
    </a>
  {{ end }}
  {{ else }}
    {{ range $page.Params.url_supp }}
      <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ . }}" target="_blank" rel="noopener">
      {{ i18n "btn_supp" }}
      </a>
    {{ end }}
{{ end }}

{{ $resource := $page.Resources.GetMatch "*.bib" }}
{{ with $resource }}
  <button type="button" class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}} js-cite-modal" data-filename="{{ .RelPermalink }}">
  {{ i18n "btn_cite" }}
  </button>
{{ end }}


{{/* range $page.Params.url_code }}
  {{ $resource := $page.Resources.GetMatch . }}
  {{ if $resource }}
    {{ $link = $resource.RelPermalink }}
  {{ else }}
    {{ $link = . | relURL }}
  {{ end }}
  <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ $link }}" target="_blank" rel="noopener">
  {{ i18n "btn_code" }}
  </a>
{{ end */}}

{{/* range $page.Params.url_dataset }}
  {{ $resource := $page.Resources.GetMatch . }}
  {{ if $resource }}
    {{ $link = $resource.RelPermalink }}
  {{ else }}
    {{ $link = . | relURL }}
  {{ end }}
  <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ $link }}" target="_blank"
  rel="noopener">
  {{ i18n "btn_dataset" }}
  </a>
{{ end */}}

{{/* range $page.Params.url_poster }}
  {{ $resource := $page.Resources.GetMatch . }}
  {{ if $resource }}
    {{ $link = $resource.RelPermalink }}
  {{ else }}
    {{ $link = . | relURL }}
  {{ end }}
  <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ $link }}" target="_blank"
  rel="noopener">
    {{ i18n "btn_poster" }}
  </a>
{{ end */}}

{{/* if $page.Params.slides }}
  {{ with (site.GetPage (printf "slides/%s" $page.Params.slides)) }}
    <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ .RelPermalink }}" target="_blank">
    {{ i18n "btn_slides" }}
    </a>
  {{ end }}
{{ else }}
  {{ range $page.Params.url_slides }}
    {{ $resource := $page.Resources.GetMatch . }}
    {{ if $resource }}
      {{ $link = $resource.RelPermalink }}
    {{ else }}
      {{ $link = . | relURL }}
    {{ end }}
    <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ $link }}" target="_blank" rel="noopener">
    {{ i18n "btn_slides" }}
    </a>
  {{ end }}
{{ end */}}

{{/* range $page.Params.url_video }}
  {{ $resource := $page.Resources.GetMatch . }}
  {{ if $resource }}
    {{ $link = $resource.RelPermalink }}
  {{ else }}
    {{ $link = . | relURL }}
  {{ end }}
  <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ $link }}" target="_blank" rel="noopener">
  {{ i18n "btn_video" }}
  </a>
{{ end */}}

{{/* range $page.Params.url_source }}
  {{ $resource := $page.Resources.GetMatch . }}
  {{ if $resource }}
    {{ $link = $resource.RelPermalink }}
  {{ else }}
    {{ $link = . | relURL }}
  {{ end }}
  <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ $link }}" target="_blank" rel="noopener">
  {{ i18n "btn_source" }}
  </a>
{{ end */}}

{{/* range $page.Params.url_supp }}
  {{ $resource := $page.Resources.GetMatch . }}
  {{ if $resource }}
    {{ $link = $resource.RelPermalink }}
  {{ else }}
    {{ $link = . | relURL }}
  {{ end }}
  <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ $link }}" target="_blank" rel="noopener">
  {{ i18n "btn_supp" }}
  </a>
{{ end */}}

{{ with $page.Params.doi }}
<a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="https://doi.org/{{ . }}"
  target="_blank" rel="noopener">
  DOI
</a>
{{ end }}

{{ range $page.Params.links }}
  {{ $pack := or .icon_pack "fas" }}
  {{ $pack_prefix := $pack }}
  {{ if in (slice "fab" "fas" "far" "fal") $pack }}
    {{ $pack_prefix = "fa" }}
  {{ end }}
  {{ $link := .url | default "" }}
  {{ $scheme := (urls.Parse $link).Scheme }}
  {{ $target := "" }}
  {{ if not $scheme }}
    {{ $resource := $page.Resources.GetMatch $link }}
    {{ if $resource }}
      {{ $link = $resource.RelPermalink }}
    {{ else }}
      {{ $link = $link | relURL }}
    {{ end }}
  {{ else if in (slice "http" "https") $scheme }}
    {{ $target = "target=\"_blank\" rel=\"noopener\"" }}
  {{ end }}
  <a class="btn btn-outline-primary my-1 mr-1{{ if $is_list }} btn-sm{{end}}" href="{{ $link | safeURL }}"
  {{ $target | safeHTMLAttr }}>
  {{ if .icon }}<i class="{{ $pack }} {{ $pack_prefix }}-{{ .icon }} {{if .name}}mr-1{{end}}"></i>{{end}}
  {{ with .name }}{{ . | safeHTML }}{{end}}
  </a>
{{ end }}
